{"version":3,"sources":["api/chat/chat.controller.js"],"names":["ref","DB","exports","getDatabyMsgSessionId","req","res","next","console","log","params","user_mobile","sender_mobile","Chat","find","MsgSessionId","$in","sort","msg_timestamp","select","exec","err","chat","status","json","success","message","create","body"],"mappings":";;AAGA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;AACA;;;;;;AARA;AAUA,MAAMA,MAAMC,mBAAGD,GAAH,CAAO,QAAP,CAAZ;;AAEA;;AAEAE,QAAQC,qBAAR,GAAgC,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACxDC,UAAQC,GAAR,CAAa,GAAEJ,IAAIK,MAAJ,CAAWC,WAAY,IAAGN,IAAIK,MAAJ,CAAWE,aAAc,EAAlE;AACAJ,UAAQC,GAAR,CAAa,GAAEJ,IAAIK,MAAJ,CAAWE,aAAc,IAAGP,IAAIK,MAAJ,CAAWC,WAAY,EAAlE;AACAE,iBAAKC,IAAL,CAAU,EAAEC,cAAc,EAAEC,KAAK,CAAE,GAAEX,IAAIK,MAAJ,CAAWC,WAAY,IAAGN,IAAIK,MAAJ,CAAWE,aAAc,EAAvD,EAA2D,GAAEP,IAAIK,MAAJ,CAAWE,aAAc,IAAGP,IAAIK,MAAJ,CAAWC,WAAY,EAAhH,CAAP,EAAhB,EAAV,EACGM,IADH,CACQ,EAAEC,eAAe,CAAjB,EADR,EAC8BC,MAD9B,CACqC,MADrC,EAC6CC,IAD7C,CACkD,CAACC,GAAD,EAAMC,IAAN,KAAe;AAC7D,QAAID,GAAJ,EAAS,OAAOf,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,SAAS,uBAA3B,EAArB,CAAP;AACT,QAAI,CAACJ,IAAL,EAAW,OAAOhB,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,SAAS,YAA3B,EAArB,CAAP;AACX,WAAOpB,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,IAAX,EAAiBH,IAAjB,EAArB,CAAP;AACD,GALH;AAMD,CATD;;AAYAnB,QAAQwB,MAAR,GAAiB,UAAUtB,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEAM,iBAAKc,MAAL,CAAYtB,IAAIuB,IAAhB,EAAsB,CAACP,GAAD,EAAMC,IAAN,KAAe;AACnC,QAAID,GAAJ,EAAS,OAAOf,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,SAAS,uBAA3B,EAArB,CAAP;AACT,WAAOpB,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,IAAX,EAAiBC,SAAS,4BAA1B,EAArB,CAAP;AACD,GAHD;AAID,CAhBD","file":"chat.controller.js","sourcesContent":["\n\n/* eslint-disable import/prefer-default-export,no-mixed-operators,no-unused-vars,max-len */\nimport crypto from 'crypto';\nimport axios from 'axios';\nimport jwt from 'jsonwebtoken';\n\nimport DB from '../../config/firebase';\n\nimport { set, add } from '../../config/redis/redisoperation';\nimport Chat from './chat.model';\n\nconst ref = DB.ref('server');\n\n/* --------------------------------- Creates a new PaymentDetail in the DB.---------------------------------*/\n\nexports.getDatabyMsgSessionId = function (req, res, next) {\n  console.log(`${req.params.user_mobile}_${req.params.sender_mobile}`);\n  console.log(`${req.params.sender_mobile}_${req.params.user_mobile}`);\n  Chat.find({ MsgSessionId: { $in: [`${req.params.user_mobile}_${req.params.sender_mobile}`, `${req.params.sender_mobile}_${req.params.user_mobile}`] } })\n    .sort({ msg_timestamp: 1 }).select('-_id').exec((err, chat) => {\n      if (err) return res.status(201).json({ success: false, message: 'Something went worng!' });\n      if (!chat) return res.status(201).json({ success: false, message: 'Not Found!' });\n      return res.status(200).json({ success: true, chat });\n    });\n};\n\n\nexports.create = function (req, res, next) {\n  // const chatRef = ref.child('chat');\n  // const chatData = {\n  //        msg_session_id: req.body.msg_session_id,\n  //        msg_text: req.body.msg_text,\n  //        user_mobile: req.body.msg_text,\n  //        sender_mobile: req.body.msg_text,\n  //      };\n\n  //      chatRef.child(chatData.msg_session_id)\n  //        .set(chatData);\n\n  Chat.create(req.body, (err, chat) => {\n    if (err) return res.status(201).json({ success: false, message: 'Something went worng!' });\n    return res.status(201).json({ success: true, message: 'Chat successfully Created!' });\n  });\n};\n"]}